# 1. æ•™ç¨‹ç®€ä»‹

## å°†ä¼šå­¦åˆ°ä»€ä¹ˆ

1. æ­å»ºæ€è·¯
2. ç†Ÿæ‚‰difyå·¥ä½œæµ
3. difyè‡ªå®šä¹‰å·¥å…·
4. difyå†…è°ƒç”¨é£ä¹¦api


## æµç¨‹å›¾


# 2. å‡†å¤‡å·¥ä½œ

## 2.1 æ·»åŠ  internlm 2.5 æ¨¡å‹ 
è¿›å…¥ç¡…åŸºæµåŠ¨å®˜ç½‘ï¼šhttps://cloud.siliconflow.cn/s/internlm

ç‚¹å‡»â€œAPIå¯†é’¥â€å¤åˆ¶å¯†é’¥ 
![å¤åˆ¶å¯†é’¥](https://github.com/user-attachments/assets/6e31de94-c3e7-46ac-a651-e748dd3ca2d7)

ç‚¹å‡»â€œå¤´åƒâ€ï¼Œç‚¹å‡»â€œè®¾ç½®â€,â€œæ¨¡å‹ä¾›åº”å•†â€é‡Œé€‰æ‹©â€œSILICONFLOWâ€,ç‚¹å‡»â€œè®¾ç½®â€ï¼Œå¡«å…¥api key,æ¨¡å‹åˆ—è¡¨å¯ä»¥çœ‹åˆ°internlm 2.5
![è®¾ç½®1](https://github.com/user-attachments/assets/8a83bb6d-ad60-4df0-9715-e1254dd3ae9e)
![è®¾ç½®2](https://github.com/user-attachments/assets/5aa9331d-955d-45b4-9ca9-c4f6cf045c21)
![è®¾ç½®3](https://github.com/user-attachments/assets/235927bb-7035-4f44-b71c-aadb7f2e83f3)
![è®¾ç½®4](https://github.com/user-attachments/assets/7053ce1c-1b92-4817-861e-2a7323ec644d)

# 2.2 åˆ›å»ºå·¥ä½œæµ

â€œåˆ›å»ºç©ºç™½åº”ç”¨â€----â€œå·¥ä½œæµâ€

![åˆ›å»ºå·¥ä½œæµ](https://github.com/user-attachments/assets/edce4ab1-2d3a-47af-8f7e-90e0597addec)

# 2.3 é£ä¹¦å¤šç»´è¡¨æ ¼å»ºç«‹

å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œè¿›è¡Œä¿®æ”¹ã€‚ä»¥ä¸‹ä»…ä¸ªäººåœ¨è®¾è®¡å­—æ®µæ—¶çš„ä¸€äº›æ€è·¯ã€‚

**2.3.1 è¡¨æ ¼è®¾è®¡å‰æ€è€ƒä¸ºä»€ä¹ˆè¦æ”¶è—è¿™ç¯‡æ–‡ç« **

â‘  å±äºä»€ä¹ˆé¢†åŸŸï¼Œå±äºä»€ä¹ˆæ€§è´¨ï¼ˆç§‘æ™®ã€çº¯æŠ€æœ¯ã€å®æ“....ï¼‰ï¼Œä»€ä¹ˆé˜¶æ®µï¼ˆåˆçº§ã€ä¸­çº§ã€è¿›é˜¶....ï¼‰ç­‰ç­‰......

â‘¡ æ–‡ç« ä¼ é€’çš„ä»€ä¹ˆï¼Œå¦‚ï¼šè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿæå‡ºä»€ä¹ˆè§‚ç‚¹ï¼Ÿä»‹ç»ä»€ä¹ˆæ–°æŠ€æœ¯ï¼Ÿè®©ä½ è§‰å¾—å€¼å¾—ç»†çœ‹çš„ç‚¹åœ¨äºï¼Ÿç­‰ç­‰......

â‘¢ åˆ«äººæ¨èçš„ï¼Œä½†æ˜¯ç°åœ¨æ²¡ç©ºç»†çœ‹ï¼Œå…ˆæ”¶å½•ä¸€ä¸‹

**2.3.2 è¡¨æ ¼è®¾è®¡**

```å­—æ®µè¯´æ˜```å¦‚ä¸‹ï¼š

| å­—æ®µå     | é£ä¹¦å­—æ®µç±»å‹ | å­—æ®µè¯´æ˜                                                                 |
|------------|---------------|--------------------------------------------------------------------------|
| æ ‡é¢˜       | æ–‡æœ¬        | æ ‡é¢˜                                                                     |
| é“¾æ¥       | æ–‡æœ¬        | åˆ†äº«çš„é“¾æ¥ï¼Œç‚¹å‡»å³å¯è·³è½¬é˜…è¯»                                               |
| æ‘˜è¦       | æ–‡æœ¬        | é€šç¯‡å¤§æ¦‚è®²äº†ä»€ä¹ˆï¼Œå¯ä»¥ç”±çˆ¬è™«æ’ä»¶ç”Ÿæˆ                              |
| æ¥æº       | å•é€‰        | æ¥è‡ªå“ªä¸ªå¹³å°ï¼Œå¦‚ï¼šbç«™ã€å°çº¢ä¹¦ã€ç½‘ç«™ç­‰ç­‰ã€‚åç»­å¦‚æœæ‰©å±•åšæ•°æ®ç»Ÿè®¡æ—¶å¯ä½œä¸ºä¸€é¡¹åˆ†ç±»æŒ‡æ ‡   |
| å½¢å¼   | å•é€‰         | å±•ç°å½¢å¼ï¼šå›¾æ–‡ï¼ˆçº¯æ–‡ä¹Ÿå½’åˆ°è¿™ç±»ï¼‰ã€è§†é¢‘                                                                |
| tag       | å¤šé€‰         | æŒ‰é¢†åŸŸã€åŠŸèƒ½ç­‰åšä¸€ä¸ªåˆ’åˆ†ï¼Œä¹Ÿå¯ä»¥ç§°å®ƒä¸ºæŸä¸ªåˆé›†ï¼Œæ¯”å¦‚äº§å“ã€AIã€å¤§æ¨¡å‹ç­‰                    |
| çŠ¶æ€       | å•é€‰         | å·²é˜…è¯»ã€æœªé˜…è¯»                                                             |
| æ”¶é›†æ—¥æœŸ   | æ–‡æœ¬        | å†™å…¥è¡¨æ ¼æ—¥æœŸï¼Œå› ä¸ºé£ä¹¦æ—¶é—´æ ¼å¼å’Œæ’ä»¶æ—¶é—´æ ¼å¼æœ‰å‡ºå…¥ï¼Œæˆ‘å¤ªæ‡’äº†ä¸æƒ³åšå¤„ç†ï¼Œç›´æ¥è®¾ç½®æ–‡æœ¬å‹ |
| æ”¶è—åŸå›    | æ–‡æœ¬        | ä¸ºä»€ä¹ˆè¦æ”¶å½•è¿™ç¯‡                                                          |
| è¯»åæ„Ÿ     | æ–‡æœ¬        | è¯»åæ„Ÿ                                                                   |
| ä»·å€¼ç­‰çº§   | å•é€‰        | è¿™ç¯‡æ–‡ç« å«é‡‘é‡æ€ä¹ˆæ ·ï¼Œå¯è‡ªå·±è®¾ç½®å€¼ï¼Œæ¯”å¦‚ï¼šä½ã€ä¸­ã€é«˜                          |

![ç©ºè¡¨ç¤ºä¾‹](https://github.com/user-attachments/assets/9ddd717f-fc23-4a8c-91d0-b7346436fb26)

**2.3.3 å…³äºåˆ†äº«é“¾æ¥**

**æ•´ç†å‡ºè‡ªå·±å¸¸çœ‹å¹³å°çš„åˆ†äº«é“¾æ¥**

æ¯”å¦‚æˆ‘å¸¸çœ‹çš„å¹³å°åˆ†äº«é“¾æ¥å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºæœ‰äº›å¹³å°åˆ†äº«é“¾æ¥éœ€è¦åšä¸€ä¸ªæå–```httpsé“¾æ¥```å¤„ç†çš„ã€‚

```å°çº¢ä¹¦åˆ†äº«é“¾æ¥```ï¼š

```
93 ã€å¤§è¿ï½œ4å¤©21é¡¿â£ï¸äººå°‘å˜å˜å¥½åƒï¼Œæœ¬åœ°äººæ¨èâ€¼ï¸ - é©¬æºœè¾¾ | å°çº¢ä¹¦ - ä½ çš„ç”Ÿæ´»æŒ‡å—ã€‘ ğŸ˜† lR3gT9A0eAQ5XWn ğŸ˜† https://www.xiaohongshu.com/discovery/item/667aacb8000000001e010eb2?source=webshare&xsec_token=AB1e31D0BGnaywnmwX7C37dGKIbrOsxGltreE-BRB1aeE=&xsec_source=pc_share
```

```çŸ¥ä¹åˆ†äº«é“¾æ¥```ï¼š

```
æ‰‹æ“ä¸€ä¸ªæœ€å°çš„ Agent ç³»ç»Ÿ â€” Tiny Agent - RedHerringçš„æ–‡ç«  - çŸ¥ä¹
https://zhuanlan.zhihu.com/p/699732624
```

```æŠ–éŸ³åˆ†äº«é“¾æ¥```ï¼š

```
9.99 Eus:/ 12/21 J@i.Ch å¤§è¿åƒä¸‡çº§åšä¸»æ€»ç»“çš„å¤§è¿æ—…æ¸¸æ³¨æ„äº‹é¡¹ï¼Œçœ‹è¿™ä¸€ä¸ªå°±è¶³å¤Ÿè¶³å¤Ÿäº† # å¤§è¿æ—…æ¸¸æ”»ç•¥ # å¤§è¿ # å¤§è¿ç¾é£Ÿ   https://v.douyin.com/iksNQqte/ å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€DouéŸ³æœç´¢ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
```

```å…¬ä¼—å·æ–‡ç« åˆ†äº«é“¾æ¥```ï¼š

```
https://mp.weixin.qq.com/s/d8mvSU77l_xAHKo3gqyPGQ
```

```Bç«™åˆ†äº«é“¾æ¥```ï¼š

```
ã€SOLIDWORKS æ•™å­¦ ç²¾å“æ•™ç¨‹ | 2024å¹´æ–°ä¿® | Bç«™ ç‚¹èµ æ’­æ”¾ æ”¶è— NO.1ã€‘ https://www.bilibili.com/video/BV1iw411Z7HZ/?share_source=copy_web&vd_source=93b749d0faa4f6da4b3a9891caf73e4d
```

```youtubeåˆ†äº«é“¾æ¥```ï¼š

```
https://youtu.be/siHNmXLZ8y4?si=2KwcS5wElJBK4Eva
```

# 3. æ­å»ºå·¥ä½œæµ

ä¹‹å‰å·²ç»åœ¨cozeæ­å»ºå¹¶è·‘é€šï¼Œcozeçš„æ•™ç¨‹æ˜¯ä¸€è¾¹è®¾è®¡ä¸€è¾¹å†™çš„ï¼Œdifyè¿™è¾¹ç›´æ¥æ‹¿å·²è·‘é€šçš„æ€è·¯æ¥å†™ã€‚

## 3.1 å®šä¹‰è¾“å…¥å˜é‡

æ ¹æ®è¡¨æ ¼æ¥çœ‹ï¼Œæˆ‘ä»¬è¦æ–°å¢çš„è¾“å…¥å˜é‡åˆ†åˆ«æœ‰```é“¾æ¥```ã€```å½¢å¼```ã€```tag```ã€```æ”¶è—åŸå› ```ã€‚

![å˜é‡åˆ†ç±»](https://github.com/user-attachments/assets/d7fad01a-d455-4c40-a4d8-10e32a35f08c)

åˆ¤æ–­æ˜¯å¦è¦è¿›è¡Œé“¾æ¥æå–ï¼Œæˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸ªbooleanå€¼çš„å˜é‡ä½œä¸ºåˆ¤æ–­ã€‚

![æ–°å¢å˜é‡](https://github.com/user-attachments/assets/d0775e71-8ef1-4ea7-8e75-abe0c3a833a3)

![handleå˜é‡é…ç½®](https://github.com/user-attachments/assets/8ee83cb5-66e4-405a-83c0-f6fcd830562c)


## 3.2 æ·»åŠ é€šç”¨å˜é‡-æ—¶é—´

![æ·»åŠ æ—¶é—´å·¥å…·](https://github.com/user-attachments/assets/f948baf3-6fda-4a9c-84b7-006a5e21211c)

## 3.3 åˆ¤æ–­å½¢å¼-å›¾æ–‡orè§†é¢‘

æ³¨æ„ï¼šäº‹å…ˆæˆ‘ä»¬è§„å®šå¥½genreï¼ˆå½¢å¼ï¼‰åªèƒ½æ˜¯å›¾æ–‡ æˆ– è§†é¢‘ã€‚

æ·»åŠ ```æ¡ä»¶åˆ†æ”¯```ï¼Œåˆ¤æ–­æ˜¯```å›¾æ–‡```è¿˜æ˜¯```è§†é¢‘```ã€‚å¦‚æœæ›´ä¸¥è°¨ç‚¹ï¼Œå¯ä»¥åŠ ä¸€ä¸ª```ELIF```æ˜¯"å›¾æ–‡"ã€‚

![æ¡ä»¶åˆ†æ”¯](https://github.com/user-attachments/assets/c5675773-a8c5-4f9c-ba30-12ce0e6a2eb0)

## 3.4 è§†é¢‘ç±»æ”¶è—å¤„ç†

### 3.4.1 åˆ¤æ–­æ˜¯å¦è¦è¿›è¡Œé“¾æ¥å¤„ç†

å¯¹äºåªæœ‰urlåœ°å€çš„ï¼š
1. è¾“å‡ºurlåœ°å€
2. æ ¹æ®reasonï¼ˆæ”¶è—ç†ç”±ï¼‰æç‚¼å‡ºæ ‡é¢˜
   
æ·»åŠ ```æ¡ä»¶åˆ†æ”¯```ï¼Œåˆ¤æ–­handleå˜é‡ï¼ˆhandleä¸ºtrueæ—¶éœ€è¦å¤„ç†ï¼Œfalseä¸éœ€è¦å¤„ç†ï¼‰

![åˆ¤æ–­æ˜¯å¦è¦è¿›è¡Œé“¾æ¥å¤„ç†](https://github.com/user-attachments/assets/eb042435-8502-44e0-bb90-1c537227721d)

### 3.4.2 æå–æ ‡é¢˜+urlåœ°å€ï¼ˆhandleä¸ºtrueåˆ†æ”¯å¤„ç†ï¼‰

éœ€è¦åš2ä»¶äº‹ï¼š
â‘  å–å‡ºurlåœ°å€
â‘¡ å–å‡ºæ ‡é¢˜

**1. æ·»åŠ å¹¶é…ç½®ä»£ç èŠ‚ç‚¹**

é€‰æ‹©ç”¨ä»£ç èŠ‚ç‚¹çš„åŸå› æ˜¯å¤§æ¨¡å‹èŠ‚ç‚¹æœ‰æ—¶å€™å¹¶ä¸èƒ½100%èƒ½æŒ‰ç…§è¦æ±‚æå–ï¼Œç”¨ä»£ç èŠ‚ç‚¹æ›´å¯é äº›ã€‚

æ·»åŠ ```ä»£ç æ‰§è¡Œ```èŠ‚ç‚¹ï¼Œè®¾ç½®è¾“å…¥è¾“å‡ºå˜é‡ã€‚

![æ·»åŠ èŠ‚ç‚¹](https://github.com/user-attachments/assets/ec69834a-1a3c-4c95-b258-8bd897ee88a3)

![é…ç½®è¾“å…¥è¾“å‡º](https://github.com/user-attachments/assets/1141a31b-2877-4e66-8a54-e34afb1d67e6)

**2. æå–urlåœ°å€ä»£ç **

![æµç¨‹å›¾](https://github.com/user-attachments/assets/0925b4ed-88d3-4a5f-8463-cb349d466951)

â‘  æŸ¥æ‰¾ URL èµ·å§‹ä½ç½®ï¼šä½¿ç”¨ find() æ–¹æ³•æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­ http:// æˆ– https:// çš„èµ·å§‹ä½ç½®ã€‚å¦‚æœæ‰¾åˆ°å…¶ä¸­ä¸€ä¸ªï¼Œå°±è®°å½•è¿™ä¸ªä½ç½®ä½œä¸º URL çš„èµ·å§‹ä½ç½®ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœ‰æ•ˆçš„ URL èµ·å§‹ä½ç½®ï¼Œè¿”å› "æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆurl"ã€‚
â‘¡ æŸ¥æ‰¾ URL ç»“æŸä½ç½®ï¼šåˆå§‹åŒ–ä¸€ä¸ªå˜é‡ end ä¸º URL çš„èµ·å§‹ä½ç½®ã€‚ä½¿ç”¨ while å¾ªç¯éå†å­—ç¬¦ä¸²ï¼Œé€ä¸ªæ£€æŸ¥å­—ç¬¦ï¼Œç»§ç»­å‘åç§»åŠ¨ end ä½ç½®ï¼Œç›´åˆ°é‡åˆ°ç©ºæ ¼ã€æ¢è¡Œç¬¦ã€é€—å·ã€å¥å·æˆ–å…¶ä»–æ ‡å¿—ç€ URL çš„ç»“æŸæ ‡ç‚¹ç¬¦å·ã€‚
â‘¢ æˆªå– URLï¼šä½¿ç”¨ç¡®å®šçš„èµ·å§‹å’Œç»“æŸä½ç½®ï¼Œä»è¾“å…¥å­—ç¬¦ä¸²ä¸­æˆªå– URLã€‚å»æ‰å¯èƒ½å­˜åœ¨çš„å‰åç©ºç™½ã€‚

```
def main(input: str) -> dict:
    # æŸ¥æ‰¾ "http://" æˆ– "https://" çš„èµ·å§‹ä½ç½®
    start = input.find("http://")
    if start == -1:
        start = input.find("https://")
    
    if start != -1:
        # æŸ¥æ‰¾ URL æœ«å°¾çš„ç©ºæ ¼ã€æ¢è¡Œç¬¦ã€é€—å·ã€å¥å·ç­‰ä½œä¸ºç»ˆæ­¢ä½ç½®
        end = start  # åˆå§‹åŒ–ç»“æŸä½ç½®ä¸ºèµ·å§‹ä½ç½®
        while end < len(input) and input[end] not in [" ", "\n", ",", "ã€‚", "ï¼Œ", "ï¼Ÿ"]:
            end += 1

        # æˆªå– URL
        url = input[start:end].strip()
        
        # é’ˆå¯¹æŠ–éŸ³çŸ­é“¾æ¥ï¼Œç¡®ä¿ä»¥ "/" ç»“å°¾
        if "v.douyin.com" in url and not url.endswith("/"):
            last_slash = url.rfind("/")
            url = url[:last_slash + 1] if last_slash != -1 else url
    else:
        url = "æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆé“¾æ¥"
    
    return {"url": url}
```


### 3.4.3 æå–urlåœ°å€+æ ¹æ®reasonæç‚¼æ ‡é¢˜ï¼ˆhandleä¸ºfalseåˆ†æ”¯å¤„ç†ï¼‰





## 3.5 å›¾æ–‡ç±»æ”¶è—å¤„ç†

##

